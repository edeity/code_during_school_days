$(function(){function e(e,a){for(var t=e,o=a,i=0,r=t/o,c=0,s=0;r>s;s++)i+=o,c+=i;for(var s=0;r+1>s;s++)i-=o,c+=i;var d=1,p=8,k=d/p*360,v=c%360-.5*k,b=(p-v/k)%p,l="0."+(""+b).split(".")[1];return l>n&&1-n>l?Math.ceil(b):-1}function a(e){var a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");if(""!==location.search){var t=window.location.search.substr(1).match(a);return t[2]}}function t(e,a){0===$(".pop-div").length?($("body").append('<div id="taobao-token-pop" class="pop-div"><div id="taobao-token"><div class="close"></div><p id="taobao-kind">'+e+'</p><a id="taobao-token-id" data-clipboard-text="'+a+'">'+a+"</a></div></div>"),$(".close").on("click",function(){$(this).parent().parent().fadeOut()})):($("#taobao-kind").text(e),$("#taobao-token-id").text(a),$("#taobao-token-pop").fadeIn())}function o(e){$("body").append('<div id="prize-token-pop" class="pop-div"><div id="prize-token"><div class="close"></div><p id="prize-token-id">'+e+"</p></div></div>"),$(".close").on("click",function(){$(this).parent().parent().fadeOut()})}function i(){var i=a("code");$.post("./lottery",{openid:i},function(a){switch(a.lottery_key){case 1:r=6;break;case 2:r=5;break;case 3:r=8;break;case 4:r=2;break;case 5:r=4;break;case 6:r=3;break;case 7:r=1;break;case 8:r=7;break;default:r=7}if(d=!1,0===a.status){p=!0;for(var i=0,n=0,k=!0,v=$("#rotate-table"),b=0;e(c,s)!==r;)c+=s;var l=setInterval(function(){if(k?n+=s:n-=s,i+=n,b++,n>=c&&(k=!1),0>n)switch(p=!1,clearInterval(l),r){case 1:t("[嘉华旅游]: 4999-100优惠券","￥嘉华旅游100元优惠券￥");break;case 2:t("[果芽]: 10元无门槛优惠券","￥果芽10元无门槛优惠券￥");break;case 3:t("[嘉华旅游]: 200-20优惠券","￥嘉华旅游20元优惠券￥");break;case 4:o(a.redeem_code);break;case 5:t("[米妮哈鲁]:满300减100元优惠券","￥米妮哈鲁399-100元优惠券￥");break;case 6:t("[米妮哈鲁]:10元无门槛优惠券","￥米妮哈鲁10元无门槛优惠劵￥");break;case 7:covering().show({txt:"好气啊, 还差一点点就中奖了!"});break;case 8:t("[honeypig]:10元无门槛优惠券","￥honeypig10元无门槛优惠券￥ ")}v.css({"-webkit-transform":"rotate("+i+"deg)"})},10)}else 1===a.status&&covering().show({txt:a.msg})}).error(function(){d=!1,covering().show({txt:"网络或服务器出了点小问题,请稍后再试"})})}covering().appendShareImg();var n=.1,r=1,c=20*Math.random()+20,s=Math.random()/10+.2,d=!1,p=!1;$("#rotate-hand").on("click",function(){d||p||(d=!0,i())})});